<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style2.css">
    <title>Simple Mario-like Game</title>
    <style>
        button#resetButton {
            position: absolute;
            top: 90%;
            left: 45%;
            padding: 15px 30px;
            font-size: 16px;
            background-color: rgb(195, 20, 76);
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }

        #voltarButton {
            position: absolute;
            top: 85%;
            left: 25%;
            padding: 15px 30px;
            background: url('assents/voltar.png') no-repeat center center;
            background-size: cover;
            border: none;
            border-radius: 35%;
            width: 80px;
            height: 80px;
            cursor: pointer;
            outline: none;
        }
        
        #temporizador {
    position: absolute;
    top: 10%;
    left: 45%;
    font-size: 24px;
    color: rgb(255, 0, 0);
}

    </style>
</head>

<body>   
    <div class="game-container">
        <div class="game-board">
            <img src="assents/personagem2.gif" class="personagem">
            <img src="assents/Yveltal atk.gif" class="oponente">
            <img src="assents/egg.gif" class="fundi">
            <img src="assents/ceu3.gif" class="c3">
            <img src="assents/ceu.gif" class="c2">
            <img src="assents/ceu.gif" class="c1">
            <img src="assents/ceu2.gif" class="egg">
        </div>
        <a href="index.html" id="voltarButton"></a>
        <button id="resetButton">Reiniciar</button>
        <div id="temporizador">00:00</div>
    </div>

    <script>
        let tempoTotal = 0;
        let temporizador;
        const temporizadorElement = document.getElementById('temporizador');

        const formatarTempo = (segundos) => {
            const minutos = Math.floor(segundos / 60);
            const segRestantes = segundos % 60;
            return `${minutos.toString().padStart(2, '0')}:${segRestantes.toString().padStart(2, '0')}`;
        };

        const iniciarTemporizador = () => {
            temporizador = setInterval(() => {
                tempoTotal++;
                temporizadorElement.textContent = formatarTempo(tempoTotal);
            }, 1000);
        };

        // Iniciar temporizador automaticamente quando a pÃ¡gina abrir
        iniciarTemporizador();

        function pararTemporizador(){
            clearInterval(temporizador);
        };

        const personagem = document.querySelector('.personagem');
        const oponente = document.querySelector('.oponente');

        const desvio = () => {
            personagem.classList.add('desvio');
            setTimeout(() => {
                personagem.classList.remove('desvio');
            }, 1000);

            const loop = setInterval(() => {
                const oponentePosition = oponente.offsetLeft;
                const personagemPosition = window.getComputedStyle(personagem).bottom.replace('px', '');

                console.log(personagemPosition);

                if (oponentePosition <= 20 && oponentePosition > 0 && personagemPosition > 80) {
                    oponente.style.animation = 'none';
                    oponente.style.left = `${oponentePosition}px`;

                    personagem.style.animation = 'none';
                    personagem.style.left = `${personagemPosition}px`;

                    personagem.src = "assents/derrota2.png";
                    personagem.style.width = '75px';
                    personagem.style.marginLeft = '-35px';

                    pararTemporizador();

                    clearInterval(loop);
                }
            }, 10);
        };

        document.addEventListener('keydown', desvio);

        const resetPage = () => {
            location.reload();
        };

        const resetButton = document.getElementById('resetButton');
        resetButton.addEventListener('click', resetPage);
    </script>
</body>

</html>